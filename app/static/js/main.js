$(document).ready(function(){if($("#custom_short_check").length){new dtsel.DTS('input[name="valid_til"]',{showTime:!0,dateFormat:"yyyy-mm-dd",timeFormat:"HH:MM"});let e=$("#valid-til");e.val().replace(",","");let t=e.val().replace(",","")+"Z";e.val(moment(t).format("YYYY-MM-DD, HH:mm")),$("#shorten-url").on("click",function(){let t=e.val().replace(",","");e.val(moment.utc(moment(t)).format("YYYY-MM-DD HH:mm"))}),$("#custom_short_check").on("change",function(){$("#short").prop("disabled",!$(this).prop("checked"))}),$("#custom_valid_til_check").on("change",function(){$("#valid-til").prop("disabled",!$(this).prop("checked"))})}let a=$("#url-shorten-form");function c(){try{let e=$("#qrcode").children("img")[0].src,t=$("#save-qr");t.attr("href",e),t.attr("target","_blank")}catch(e){}}a.submit(function(o){$.ajax({type:"POST",url:"/shorten",data:a.serialize(),success:function(a){let c=$(".shorten-url-success-container");if(c.empty(),a.data.hasOwnProperty("response")){let o=root_url+a.data.response,s=`<div class="shorten-url-success alert alert-success">\n                                        <div id="qrcode"></div>\n                                        <div id="shorten-url-text">\n                                            <p>URL shortened succesfully!</p>\n                                            <p>${o}</p>\n                                            <a class="btn btn-success" id="save-qr" href="#">Save QR Code</a>\n                                        </div>\n                                    </div>`;c.append(s),new QRCode("qrcode",{width:512,height:512}).makeCode(o),$("#custom_short_check").length&&(n.prop("checked")&&n.click(),r.prop("checked")&&r.click(),$("#short").val(""),$("#url-input").val(""),e.val(moment(t).format("YYYY-MM-DD, HH:mm")))}else for(let e in a.data)if(a.data.hasOwnProperty(e)){let t=`<div class="shorten-url-success alert alert-danger">\n                                            ${a.data[e]}\n                                        </div>`;c.append(t)}},complete:function(){setTimeout(c,100)}}),o.preventDefault()}),$.ajaxSetup({beforeSend:function(e,t){/^(GET|HEAD|OPTIONS|TRACE)$/i.test(t.type)||this.crossDomain||e.setRequestHeader("X-CSRFToken","{{ form.csrf_token._value() }}")}})});